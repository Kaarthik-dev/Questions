AWS Account Compromise (SOC Analyst View)
Overview

An AWS production account showed unauthorized API activity originating from a foreign IP address.
The investigation confirmed credential compromise and privilege escalation, requiring immediate containment.

This case study demonstrates how a SOC analyst detects, analyzes, and responds to a cloud security incident.

Environment

Cloud Provider: AWS

Account Type: Production

Key Services:

IAM

S3

VPC

Security Tooling:

GuardDuty

CloudTrail

SIEM (centralized logs)

Detection

An alert was generated by AWS GuardDuty indicating anomalous API activity.

Why this was suspicious

Access from a new geolocation

Activity outside normal business hours

IAM-related API calls with high privilege impact

Timeline (Example)
Time (UTC)	Event
02:14	GuardDuty alert triggered
02:16	CloudTrail shows new IAM access key creation
02:18	ListBuckets API call from foreign IP
02:21	AdministratorAccess policy attached
02:24	SOC escalates incident
02:27	IAM user disabled
Logs Used
CloudTrail

API activity:

CreateAccessKey

AttachUserPolicy

ListBuckets

Source IP and user ARN

Timestamp correlation

GuardDuty

Threat detection

Geolocation anomaly

Behavior deviation from baseline

VPC Flow Logs

Network behavior review

No evidence of lateral movement

IAM Access Advisor

Verified permissions used

Confirmed admin-level access post-compromise

Analysis

Key indicators confirmed this was a true security incident:

IAM access from an unfamiliar country

Creation of access keys without change approval

Immediate privilege escalation to admin

No matching maintenance window or ticket

This ruled out legitimate administrative activity.

Decision Points
Is this compromised or admin activity?

No approved change request

Unusual geolocation

Risky API sequence
Decision: Compromised

Do we disable the IAM user immediately?

Active misuse of admin permissions

High blast radius

Faster containment required
Decision: Yes, user disabled immediately

Any production impact?

No EC2 termination

No S3 deletion

No persistence observed
Decision: No immediate impact

Containment

Disabled compromised IAM user

Revoked all active access keys

Removed unauthorized admin policies

Escalated to cloud security team

Eradication

Rotated credentials

Reviewed IAM users and access keys

Enforced MFA

Removed unused permissions

Recovery

Restored legitimate access

Migrated to role-based access

Improved GuardDuty alerting

Updated SOC runbooks

Lessons Learned

Long-lived access keys increase risk

MFA should be mandatory

Least privilege reduces blast radius

Early detection prevents damage

Interview Takeaway

Security tools generate alerts.
SOC analysts validate incidents and act decisively.
